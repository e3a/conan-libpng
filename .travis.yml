sudo: required 
language: cpp
services:
  - docker
env:
  global:
    secure: "XXs4pzoHPbOwWwkW7YPqzP7MejoyyTfF1lHFAmNZc2eLQ/wHs1Tx58FqIdum0aFeF+nrZJCYlaAojIcAlS5SGkUqbzHcAWuR0rtez60LN08XlwC68/uL/RgP517xtXxt2nK2GblNdsuxHmfvAGkgkImNVyjm7dmyo4KzN4gvOubxBBzkFMyuoxHPeYZQ/merZbBcZPuWKjN/kVvy2jMd/+LiiILIu9aeW1BMzirn3MROfp4w2pgq4r155oVRfsA3T0jgpPYfDOdjVQMZHl1m5DeJdLuD048mcTTRTUbQiqqnQk2Ou+20E1dLJ9Z/I/CFwARpQ4OZSgwhOpdnuF4xXQyUxYIKR4SHWcCnsF7eKz+8+2DMJ8730+hXqREC0GELL4b6+FNDHedcECgHgrCtFDUha8/lqLf+uZw98CrlmdhyHt0qCZUc2qcB5bk7+Tct5u1LPt20Jt9EFc0G9tRCOk7VPZonJ+rTdx9jjwzLa74noxUiNgZuXcmnRFo5jMWs1HJ2Sb9jfkNaEC7Z3UgLb4efuMb34h4m4YYa6U3jYtAUTpPMrGM66SGDLv1ZOvkv5kALwCpyAAfXUKt3no5dokvPEzCJbbq0K/Pr/HtXvV71Em4R2/fvJBTUui5IZesANVHA+9Z0BbMp2C4lq3D4owCHl0S5a+i7HknRWobZvGg=" #BINTRAY_KEY

before_install:
  - mkdir $(pwd)/build
  - docker pull spielhuus/toolchain:latest
script:
  - sudo docker run -itd -v $(pwd)/repo:/repo --name conan_build spielhuus/toolchain /bin/bash 
  - sudo docker exec conan_build /bin/bash -c "git clone https://github.com/e3a/conan-libpng.git /repo"
  - sudo docker exec conan_build /bin/bash -c "conan user -p $BINTRAY_KEY -r conan-cpp squawkcpp"
  - sudo docker exec conan_build /bin/bash -c "cd /repo && conan export conan-cpp/latest && conan install libpng/1.6.34@conan-cpp/latest --build=libpng && conan upload libpng/1.6.34@conan-cpp/latest --all -r=conan-cpp"
  - sudo docker rm -f conan_build

